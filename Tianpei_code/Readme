This is code by Tianpei Xie.
